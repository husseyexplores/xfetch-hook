var xfetch;(xfetch||={}).xhrHook=(()=>{var w=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var _=(e,n)=>{for(var i in n)w(e,i,{get:n[i],enumerable:!0})},v=(e,n,i,u)=>{if(n&&typeof n=="object"||typeof n=="function")for(let f of A(n))!S.call(e,f)&&f!==i&&w(e,f,{get:()=>n[f],enumerable:!(u=O(n,f))||u.enumerable});return e};var C=e=>v(w({},"__esModule",{value:!0}),e);var k={};_(k,{default:()=>P});var L=e=>{if(/^https?/.test(e))return e;let n=window.location.protocol+"//"+window.location.host;return e[0]==="/"?n+e:n+window.location.pathname+"/"+e},M=e=>[...e.entries()].reduce((n,[i,u])=>(n[i]=u,n),{});var E=(e,n,i=null)=>e.reduce((u,f)=>f.call(i,u),n);function P({namespace:e=globalThis||window}={}){if(e==null&&(e=globalThis||window),typeof e!="object")throw new Error("[xfetch-hook] - `namespace` should be an object");let n=e.XMLHttpRequest;if(typeof n!="function")throw new Error("[xfetch-hook] - `XMLHttpRequest` should be a function.");let i=[];function u(){let o=new n,t=this,d,l,p,b,g,h,x,H,m=[],q=[];this.onreadystatechange=null,o.onreadystatechange=function(){if(p&&this.readyState==4){let r=o.responseType;try{t.response=H||(H=E(m,o.response,t)),(r===""||r==="text")&&(t.responseText=o.responseText),q.forEach(a=>a.call(t,t.response,t))}catch(a){console.warn("Error in proxied xfetch-hook package",a.message)}}if(t.onreadystatechange)return t.onreadystatechange()},["status","statusText","readyState","responseXML","upload"].forEach(function(r){Object.defineProperty(t,r,{get:function(){return o[r]}})}),["ontimeout, timeout","withCredentials","onload","onerror","onprogress","responseType"].forEach(function(r){Object.defineProperty(t,r,{get:function(){return o[r]},set:function(a){r==="onload"&&typeof a=="function"&&(a=a.bind(t)),o[r]=a}})}),["addEventListener","abort","getAllkeyResponseHeaders","getAllResponseHeaders","getResponseHeader","overrideMimeType"].forEach(function(r){Object.defineProperty(t,r,{value:function(){return o[r].apply(o,arguments)}})});let y=new Headers;t.setRequestHeader=function(a,c){y.append(a,c)},t.open=function(a,c,s,j,U){d=a,l=new URL(L(c)),p=s!==!1,b=j,g=U,o.open(d,l.toString(),p,b,g)},t.send=async function(a){if(h=a,p){for(let c of i){let s=await c({method:d,url:l,body:h,get headers(){return x||(x=M(y))}});!s||(s.method&&(d=s.method),s.url&&(l=s.url.href||s.url),s.body!==void 0&&(h=s.body),s.headers instanceof Headers&&(y=s.headers),typeof s.transformResponse=="function"&&m.push(s.transformResponse),typeof s.listen=="function"&&q.push(s.listen))}o.open(d,l,p,b,g);for(let c of y.entries())o.setRequestHeader(c[0],c[1])}o.send(h)}}Object.defineProperty(u,"name",{value:"XMLHttpRequest",configurable:!0});function f(){e.XMLHttpRequest=u}f();function R(){e.XMLHttpRequest=n}function T(o){i=i.filter(t=>t!==o)}function X(o){i.push(o)}return u.stopProxying=R,u.onRequest=function(t){if(typeof t!="function")throw new Error("[onRequest] - Argument must be a function");let d=()=>T(t);return i.find(p=>p===t)||X(t),d},R}return C(k);})();
xfetch.xhrHook = xfetch.xhrHook.default;
